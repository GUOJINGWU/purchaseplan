$(function() {
	layui.use([ 'form' ], function() {
		var form = layui.form();
		form.on('radio(plan-type)', function(data) {
			if (data.value == 2) {
				console.log(data.value);
				$('.emergency-item').show();
				form.render();
			} else if (data.value == 1) {
				console.log(data.value);
				$('.emergency-item').hide();
				form.render();
			}
		});
	});
});

// 添加人员弹窗
function addMember() {
	var currentProjectURL = $("#currentProjectURL").val();
	OpenSimpleUrl("add-people", "添加人员", currentProjectURL + "/pageJump", '640px', '416px');
}

// 添加物资弹窗
function addMaterial() {
	var currentProjectURL = $("#currentProjectURL").val();
	var informationId = $("#informationId").val();
	var purchasetype = $("#purchaseType").val();
	var url = "/purchaseplan/addmaterial?informationid=" + informationId + "&purchasetype=" + purchasetype;
	console.log(url);
	OpenSimpleUrl("add-material", "添加物资", url, '940px', '600px');
}
//批量导入弹窗
function batchImport() {
	var informationId = $("#informationId").val();
	var purchasetype = $("#purchaseType").val();
	OpenSimpleUrl("batchImportSheet", "批量导入", "/purchaseplan/batchimportsheet?informationid="+informationId+"&purchasetype=" + purchasetype, '540px', '416px');
}
//查看详情
function watchDetail() {
	var currentProjectURL = $("#currentProjectURL").val();
	OpenSimpleUrl("watch-detail", "查看详情", currentProjectURL + "/pageJump2", '640px', '500px');
}
//选择供应商
function supplierSelection() {
	var txt = '<div style="padding: 10px;">' + '<div style="width:465px;height:32px;margin:20px auto">' + '<label style="margin-right:20px">供应商名称</label>'
			+ '<input type="text" class="search-input" style="width:270px;height:32px;margin:0 auto;" />' + '<a class="plan-radius-btn" style="margin-left:20px">搜索</a>' + '</div>'
			+ '<div style="height:262px;overflow-y:auto;">' + '<table class="layui-table">' + '<colgroup>' + '<col width="15%" />' + '<col width="35%" />' + '<col width="20%" />' +

			'</colgroup>' + '<thead>' + '<tr>' + '<th class="yzc-aCenter">序号</th>' + '<th class="yzc-aCenter">供应商名称</th>' + '<th class="yzc-aCenter">操作</th>' +

			'</tr>' + '</thead>' + '<tbody>' + '<tr>' + '<td class="yzc-aCenter">1</td>' + '<td class="yzc-aCenter supplier-name">供应商1</td>'
			+ '<td class="yzc-aCenter plan-a select-supplier" id="supplier1" onclick="toChoose1()">选择</td>' +

			'</tr>' + '<tr>' + '<td class="yzc-aCenter">1</td>' + '<td class="yzc-aCenter supplier-name">供应商2</td>'
			+ '<td class="yzc-aCenter plan-a select-supplier" id="supplier2"  onclick="toChoose2()">选择</td>' +

			'</tr>' + '</tbody>' + '</table>' + '</div>' + '</div>';
	confirmDialog("选择供应商", txt, function() {

	});
}

//选择供应商
function toChoose1() {
	var supplierName = $("#supplier1").siblings(".supplier-name").html();
	$(".search-input").val(supplierName);
}

function toChoose2() {
	var supplierName = $("#supplier2").siblings(".supplier-name").html();
	$(".search-input").val(supplierName);
}

function searchPlan() {
	var informationId = $("#informationId").val();
	var url = "/purchaseplan/demandplansheettable?informationid=" + informationId;
	console.log(url);
	$('#demandPlanSheetTable').load(url,function (){
		editNumber();
	});
}

function removePlan(goodId) {
	confirmDialog("确认取消", "确认取消？", function() {
		var datas = {
				id : goodId
			};
		$.ajax({
			url : '/purchaseplanrest/removepurchaseplanlist',
			type : 'POST',
			contentType : 'application/json; charset=UTF-8',
			datType : "JSON",
			data : JSON.stringify(datas),
			async : false,
			success : function(data) {
				searchPlan();
			},
			error : function(data) {
				console.log(data);
			}
		});
	});
}
